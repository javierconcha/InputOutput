cd /Users/javier/Desktop/Javier/PHD_RIT/LDCM/InputOutput/140929
%% LUT from HL with 120 wavelength

wavelength = [...
  4.02500E+02  4.07500E+02  4.12500E+02  4.17500E+02  4.22500E+02  4.27500E+02  4.32500E+02  4.37500E+02  4.42500E+02  4.47500E+02 ...
  4.52500E+02  4.57500E+02  4.62500E+02  4.67500E+02  4.72500E+02  4.77500E+02  4.82500E+02  4.87500E+02  4.92500E+02  4.97500E+02 ...
  5.02500E+02  5.07500E+02  5.12500E+02  5.17500E+02  5.22500E+02  5.27500E+02  5.32500E+02  5.37500E+02  5.42500E+02  5.47500E+02 ...
  5.52500E+02  5.57500E+02  5.62500E+02  5.67500E+02  5.72500E+02  5.77500E+02  5.82500E+02  5.87500E+02  5.92500E+02  5.97500E+02 ...
  6.02500E+02  6.07500E+02  6.12500E+02  6.17500E+02  6.22500E+02  6.27500E+02  6.32500E+02  6.37500E+02  6.42500E+02  6.47500E+02 ...
  6.52500E+02  6.57500E+02  6.62500E+02  6.67500E+02  6.72500E+02  6.77500E+02  6.82500E+02  6.87500E+02  6.92500E+02  6.97500E+02 ...
  7.02500E+02  7.07500E+02  7.12500E+02  7.17500E+02  7.22500E+02  7.27500E+02  7.32500E+02  7.37500E+02  7.42500E+02  7.47500E+02 ...
  7.52500E+02  7.57500E+02  7.62500E+02  7.67500E+02  7.72500E+02  7.77500E+02  7.82500E+02  7.87500E+02  7.92500E+02  7.97500E+02 ...
  8.02500E+02  8.07500E+02  8.12500E+02  8.17500E+02  8.22500E+02  8.27500E+02  8.32500E+02  8.37500E+02  8.42500E+02  8.47500E+02 ...
  8.52500E+02  8.57500E+02  8.62500E+02  8.67500E+02  8.72500E+02  8.77500E+02  8.82500E+02  8.87500E+02  8.92500E+02  8.97500E+02 ...
  9.02500E+02  9.07500E+02  9.12500E+02  9.17500E+02  9.22500E+02  9.27500E+02  9.32500E+02  9.37500E+02  9.42500E+02  9.47500E+02 ...
  9.52500E+02  9.57500E+02  9.62500E+02  9.67500E+02  9.72500E+02  9.77500E+02  9.82500E+02  9.87500E+02  9.92500E+02  9.97500E+02];

wavelength = wavelength'*0.001; % um
%% HL angles
fmu = [...% (quad-center mu values)
   4.35778E-002   1.72987E-001   3.40719E-001   4.98097E-001   6.40342E-001   7.63129E-001   8.62730E-001   9.36117E-001   9.81060E-001   9.98097E-001];
phi = [...% (quad-center phi values) in radians; for deg: phi*180/pi
   0.00000E+000   2.61799E-001   5.23599E-001   7.85398E-001   1.04720E+000   1.30900E+000   1.57080E+000   1.83260E+000   2.09440E+000   2.35619E+000 ...
   2.61799E+000   2.87979E+000   3.14159E+000   3.40339E+000   3.66519E+000   3.92699E+000   4.18879E+000   4.45059E+000   4.71239E+000   4.97419E+000 ...
   5.23599E+000   5.49779E+000   5.75959E+000   6.02139E+000];
zeta = [...% (optical depths of output)
   0.00000E+000   1.60261E-002   8.01303E+000   8.02906E+000   1.60261E+001   1.60421E+001   2.40391E+001   2.40551E+001   3.20521E+001   3.20681E+001];
z = [...% (geometric depths of output)
   0.00000E+000   1.00000E-002   5.00000E+000   5.01000E+000   1.00000E+001   1.00100E+001   1.50000E+001   1.50100E+001   2.00000E+001   2.00100E+001];
bndmu = [...% (quad boundary mu values)
   8.71556E-002   2.58819E-001   4.22618E-001   5.73576E-001   7.07107E-001   8.19152E-001   9.06308E-001   9.65926E-001   9.96195E-001   1.00000E+000];
bndphi = [...% (quad boundary phi values)
   1.30900E-001   3.92699E-001   6.54498E-001   9.16298E-001   1.17810E+000   1.43990E+000   1.70170E+000   1.96350E+000   2.22529E+000   2.48709E+000 ...
   2.74889E+000   3.01069E+000   3.27249E+000   3.53429E+000   3.79609E+000   4.05789E+000   4.31969E+000   4.58149E+000   4.84329E+000   5.10509E+000 ...
   5.36689E+000   5.62869E+000   5.89049E+000   6.15229E+000];
omega = [...% (quad solid angles)
   2.28173E-002   4.49414E-002   4.28825E-002   3.95208E-002   3.49582E-002   2.93334E-002   2.28173E-002   1.56080E-002   7.92438E-003   2.39093E-002];

%% Ed from D file in HL
% Example:
% Ed (downwelling plane irradiance)
%    8.17029E-001   7.88264E-001   7.84853E-001   7.26994E-002   7.23485E-002   6.63829E-003   6.60688E-003   6.26797E-004   6.23855E-004   5.98649E-005
%    5.95847E-005

xxEd = load('./Dfile_140929_Ed.txt');

Ed_nadir = xxEd(:,1);

figure
fs = 15;
set(gcf,'color','white')
set(gca,'fontsize',fs)
plot(wavelength,Ed_nadir,'.-r')
hold on
plot(wavelength,xxEd)

%% RAD0Ma from D file in HL
% Example:
% RAD0Ma (direct upward radiances in air (surface-reflected sky radiance))
%    6.37379E-002   3.60117E-002   1.43013E-002   4.98842E-003   1.96328E-003   1.08984E-003   8.47102E-004   8.20485E-004   9.22914E-004   1.24934E-003
%    6.50501E-002   3.60592E-002   1.41632E-002   4.92866E-003   1.95473E-003   1.09029E-003   8.51769E-004   8.28735E-004   9.30547E-004   0.00000E+000
%    6.61847E-002   3.47889E-002   1.34750E-002   4.78450E-003   1.93016E-003   1.09624E-003   8.69237E-004   8.47374E-004   9.52178E-004   0.00000E+000
%    5.89225E-002   3.23621E-002   1.27536E-002   4.55131E-003   1.89418E-003   1.10583E-003   8.94966E-004   8.82609E-004   9.82112E-004   0.00000E+000
%    5.38058E-002   3.00322E-002   1.21008E-002   4.40345E-003   1.88584E-003   1.14793E-003   9.48365E-004   9.42595E-004   1.03563E-003   0.00000E+000
%    5.23368E-002   2.98968E-002   1.19301E-002   4.43028E-003   1.96929E-003   1.23207E-003   1.03979E-003   1.02984E-003   1.10396E-003   0.00000E+000
%    5.46148E-002   3.06912E-002   1.25295E-002   4.78430E-003   2.19536E-003   1.40955E-003   1.19076E-003   1.16613E-003   1.20751E-003   0.00000E+000
%    5.86510E-002   3.38224E-002   1.38607E-002   5.41172E-003   2.57811E-003   1.70660E-003   1.46186E-003   1.38803E-003   1.34865E-003   0.00000E+000
%    6.86541E-002   3.89978E-002   1.66349E-002   6.78934E-003   3.39145E-003   2.33097E-003   1.98523E-003   1.76817E-003   1.53423E-003   0.00000E+000
%    8.89028E-002   5.06174E-002   2.21136E-002   9.66328E-003   5.37108E-003   3.92987E-003   3.33262E-003   2.50494E-003   1.75725E-003   0.00000E+000
%    1.28137E-001   7.18527E-002   3.39236E-002   1.88306E-002   1.45702E-002   1.18477E-002   7.59231E-003   3.80882E-003   2.08858E-003   0.00000E+000
%    1.85195E-001   1.25130E-001   9.07931E-002   7.89794E-002   6.33597E-002   3.79710E-002   1.68808E-002   5.89258E-003   2.27579E-003   0.00000E+000
%    2.78201E-001   2.22569E-001   1.93604E-001   1.67456E-001   1.15546E-001   6.04083E-002   2.28854E-002   6.89249E-003   2.36743E-003   0.00000E+000
%    1.85194E-001   1.25130E-001   9.07930E-002   7.89793E-002   6.33597E-002   3.79710E-002   1.68807E-002   5.89258E-003   2.27579E-003   0.00000E+000
%    1.28137E-001   7.18525E-002   3.39235E-002   1.88305E-002   1.45702E-002   1.18476E-002   7.59230E-003   3.80881E-003   2.08858E-003   0.00000E+000
%    8.89014E-002   5.06165E-002   2.21133E-002   9.66313E-003   5.37100E-003   3.92983E-003   3.33260E-003   2.50493E-003   1.75725E-003   0.00000E+000
%    6.86522E-002   3.89969E-002   1.66348E-002   6.78937E-003   3.39143E-003   2.33093E-003   1.98519E-003   1.76814E-003   1.53422E-003   0.00000E+000
%    5.86513E-002   3.38224E-002   1.38605E-002   5.41153E-003   2.57804E-003   1.70657E-003   1.46184E-003   1.38801E-003   1.34864E-003   0.00000E+000
%    5.46146E-002   3.06912E-002   1.25297E-002   4.78440E-003   2.19539E-003   1.40955E-003   1.19075E-003   1.16612E-003   1.20750E-003   0.00000E+000
%    5.23367E-002   2.98967E-002   1.19299E-002   4.43018E-003   1.96925E-003   1.23207E-003   1.03978E-003   1.02984E-003   1.10396E-003   0.00000E+000
%    5.38061E-002   3.00324E-002   1.21010E-002   4.40355E-003   1.88587E-003   1.14794E-003   9.48366E-004   9.42593E-004   1.03562E-003   0.00000E+000
%    5.89227E-002   3.23621E-002   1.27535E-002   4.55123E-003   1.89413E-003   1.10582E-003   8.94964E-004   8.82609E-004   9.82111E-004   0.00000E+000
%    6.61839E-002   3.47886E-002   1.34749E-002   4.78451E-003   1.93017E-003   1.09624E-003   8.69237E-004   8.47374E-004   9.52177E-004   0.00000E+000
%    6.50509E-002   3.60596E-002   1.41633E-002   4.92870E-003   1.95475E-003   1.09030E-003   8.51771E-004   8.28735E-004   9.30547E-004   0.00000E+000

xxRAD0Ma = load('./Dfile_140929_RAD0Ma.txt');
RAD0Ma_nadir = xxRAD0Ma(1:24:end,10);

figure
fs = 15;
set(gcf,'color','white')
set(gca,'fontsize',fs)
plot(wavelength,RAD0Ma_nadir)

%% radsky from D file in HL
% radsky (total incident sky radiance)
%    2.41181E-001   1.50513E-001   8.68378E-002   5.87855E-002   4.48465E-002   3.80488E-002   3.56234E-002   3.64287E-002   4.02235E-002   5.08905E-002
%    2.36164E-001   1.47636E-001   8.55030E-002   5.81935E-002   4.46700E-002   3.81135E-002   3.58199E-002   3.66805E-002   4.04604E-002   0.00000E+000
%    2.22500E-001   1.39892E-001   8.19942E-002   5.67168E-002   4.43226E-002   3.84155E-002   3.64711E-002   3.74701E-002   4.11853E-002   0.00000E+000
%    2.03990E-001   1.29696E-001   7.76623E-002   5.51709E-002   4.43027E-002   3.92549E-002   3.77558E-002   3.89015E-002   4.24393E-002   0.00000E+000
%    1.85833E-001   1.20343E-001   7.43483E-002   5.46732E-002   4.53083E-002   4.10750E-002   3.99633E-002   4.11568E-002   4.42903E-002   0.00000E+000
%    1.73285E-001   1.15158E-001   7.39211E-002   5.63932E-002   4.81268E-002   4.44481E-002   4.35285E-002   4.45249E-002   4.68288E-002   0.00000E+000
%    1.70411E-001   1.16747E-001   7.79434E-002   6.14577E-002   5.37054E-002   5.02393E-002   4.91932E-002   4.94694E-002   5.01542E-002   0.00000E+000
%    1.79462E-001   1.26806E-001   8.78503E-002   7.14067E-002   6.37954E-002   6.02684E-002   5.84437E-002   5.67308E-002   5.43360E-002   0.00000E+000
%    2.01432E-001   1.47058E-001   1.06385E-001   9.01638E-002   8.32336E-002   7.92526E-002   7.44359E-002   6.73711E-002   5.93275E-002   0.00000E+000
%    2.37788E-001   1.81741E-001   1.41555E-001   1.29972E-001   1.26930E-001   1.19898E-001   1.03365E-001   8.24131E-002   6.48189E-002   0.00000E+000
%    2.90396E-001   2.38861E-001   2.12343E-001   2.25700E-001   2.40566E-001   2.14597E-001   1.54036E-001   1.01353E-001   7.00873E-002   0.00000E+000
%    3.50201E-001   3.15052E-001   3.33489E-001   4.43182E-001   5.59422E-001   4.27051E-001   2.24570E-001   1.19390E-001   7.40168E-002   0.00000E+000
%    3.79946E-001   3.57553E-001   4.16706E-001   6.57820E-001   2.08019E+001   6.61232E-001   2.65715E-001   1.27233E-001   7.54880E-002   0.00000E+000
%    3.50200E-001   3.15051E-001   3.33487E-001   4.43178E-001   5.59414E-001   4.27046E-001   2.24569E-001   1.19390E-001   7.40167E-002   0.00000E+000
%    2.90396E-001   2.38861E-001   2.12342E-001   2.25699E-001   2.40564E-001   2.14596E-001   1.54035E-001   1.01353E-001   7.00873E-002   0.00000E+000
%    2.37788E-001   1.81741E-001   1.41555E-001   1.29971E-001   1.26930E-001   1.19898E-001   1.03364E-001   8.24130E-002   6.48189E-002   0.00000E+000
%    2.01432E-001   1.47057E-001   1.06385E-001   9.01636E-002   8.32335E-002   7.92524E-002   7.44357E-002   6.73710E-002   5.93275E-002   0.00000E+000
%    1.79462E-001   1.26806E-001   8.78501E-002   7.14065E-002   6.37952E-002   6.02682E-002   5.84435E-002   5.67307E-002   5.43360E-002   0.00000E+000
%    1.70411E-001   1.16747E-001   7.79433E-002   6.14576E-002   5.37053E-002   5.02392E-002   4.91931E-002   4.94693E-002   5.01541E-002   0.00000E+000
%    1.73285E-001   1.15158E-001   7.39211E-002   5.63931E-002   4.81267E-002   4.44481E-002   4.35284E-002   4.45248E-002   4.68288E-002   0.00000E+000
%    1.85833E-001   1.20343E-001   7.43484E-002   5.46732E-002   4.53082E-002   4.10750E-002   3.99632E-002   4.11567E-002   4.42903E-002   0.00000E+000
%    2.03990E-001   1.29696E-001   7.76622E-002   5.51709E-002   4.43027E-002   3.92550E-002   3.77558E-002   3.89016E-002   4.24393E-002   0.00000E+000
%    2.22500E-001   1.39892E-001   8.19941E-002   5.67168E-002   4.43225E-002   3.84155E-002   3.64711E-002   3.74701E-002   4.11853E-002   0.00000E+000
%    2.36163E-001   1.47636E-001   8.55029E-002   5.81935E-002   4.46700E-002   3.81135E-002   3.58199E-002   3.66805E-002   4.04605E-002   0.00000E+000
xxradsky = load('./Dfile_140929_radsky.txt');
radsky_nadir = xxradsky(1:24:end,10);

figure
fs = 15;
set(gcf,'color','white')
set(gca,'fontsize',fs)
plot(wavelength,radsky_nadir)
%% rho from P in HL
%    I   J    Theta      Phi  Phi-view      L(sky)      L(water-lv)    L(refl-sky)    L(total up)       Rrs           rho
%            (zenith)                                                                                             (Lrefl/Lsky)
%   10   1      0.0      0.0      0.0    5.08905E-02    3.27024E-03    1.24934E-03    4.51958E-03    4.00260E-03    0.024550
%    9   1     10.0      0.0    180.0    4.02241E-02    3.32190E-03    9.22914E-04    4.24481E-03    4.06582E-03    0.022944
%    9   4     10.0     45.0    135.0    4.24389E-02    3.30817E-03    9.82112E-04    4.29028E-03    4.04902E-03    0.023142
%    9   7     10.0     90.0     90.0    5.01544E-02    3.31001E-03    1.20751E-03    4.51752E-03    4.05127E-03    0.024076
%    8   1     20.0      0.0    180.0    3.64294E-02    3.37629E-03    8.20485E-04    4.19677E-03    4.13240E-03    0.022523
%    8   4     20.0     45.0    135.0    3.89011E-02    3.33998E-03    8.82609E-04    4.22259E-03    4.08795E-03    0.022689
%    8   7     20.0     90.0     90.0    4.94697E-02    3.35060E-03    1.16613E-03    4.51673E-03    4.10096E-03    0.023573
%    7   1     30.0      0.0    180.0    3.56241E-02    3.45778E-03    8.47102E-04    4.30489E-03    4.23214E-03    0.023779
%    7   4     30.0     45.0    135.0    3.77554E-02    3.44632E-03    8.94966E-04    4.34129E-03    4.21811E-03    0.023704
%    7   7     30.0     90.0     90.0    4.91937E-02    3.44797E-03    1.19076E-03    4.63873E-03    4.22012E-03    0.024206
%    6   1     40.0      0.0    180.0    3.80494E-02    3.54840E-03    1.08984E-03    4.63824E-03    4.34305E-03    0.028643
%    6   4     40.0     45.0    135.0    3.92545E-02    3.52690E-03    1.10583E-03    4.63273E-03    4.31673E-03    0.028171
%    6   7     40.0     90.0     90.0    5.02395E-02    3.54962E-03    1.40955E-03    4.95918E-03    4.34455E-03    0.028057
%    5   1     50.0      0.0    180.0    4.48475E-02    3.65627E-03    1.96328E-03    5.61956E-03    4.47508E-03    0.043777
%    5   4     50.0     45.0    135.0    4.43114E-02    3.61179E-03    1.89418E-03    5.50597E-03    4.42064E-03    0.042747
%    5   7     50.0     90.0     90.0    5.36442E-02    3.66282E-03    2.19536E-03    5.85818E-03    4.48309E-03    0.040924
%    4   1     60.0      0.0    180.0    5.87865E-02    3.66582E-03    4.98842E-03    8.65424E-03    4.48677E-03    0.084857
%    4   4     60.0     45.0    135.0    5.51704E-02    3.61405E-03    4.55131E-03    8.16536E-03    4.42340E-03    0.082496
%    4   7     60.0     90.0     90.0    6.14580E-02    3.73445E-03    4.78430E-03    8.51875E-03    4.57077E-03    0.077847
%    3   1     70.0      0.0    180.0    8.68392E-02    3.46308E-03    1.43013E-02    1.77644E-02    4.23862E-03    0.164687
%    3   4     70.0     45.0    135.0    7.76616E-02    3.45028E-03    1.27536E-02    1.62039E-02    4.22295E-03    0.164220
%    3   7     70.0     90.0     90.0    7.79439E-02    3.59541E-03    1.25295E-02    1.61250E-02    4.40059E-03    0.160751
%    2   1     80.0      0.0    180.0    1.50515E-01    3.01346E-03    3.60117E-02    3.90252E-02    3.68832E-03    0.239257
%    2   4     80.0     45.0    135.0    1.29695E-01    2.99524E-03    3.23621E-02    3.53573E-02    3.66601E-03    0.249525
%    2   7     80.0     90.0     90.0    1.16748E-01    3.14466E-03    3.06912E-02    3.38359E-02    3.84890E-03    0.262884
%    1   1     87.5      0.0    180.0    2.41185E-01    2.46198E-03    6.37379E-02    6.61999E-02    3.01333E-03    0.264270
%    1   4     87.5     45.0    135.0    2.03988E-01    2.32959E-03    5.89225E-02    6.12521E-02    2.85129E-03    0.288852
%    1   7     87.5     90.0     90.0    1.70412E-01    2.72701E-03    5.46148E-02    5.73418E-02    3.33771E-03    0.320487

xxrho = load('./Pfile_140929_rho.txt');
Lsky_nadir = xxrho(1:28:end,6);
Lrefl_sky_nadir = xxrho(1:28:end,8);
Rrs_nadir = xxrho(1:28:end,10);

Rrs_theta_phi = reshape(xxrho(:,10),28,size(wavelength,1));

figure
fs = 15;
set(gcf,'color','white')
set(gca,'fontsize',fs)
plot(wavelength,Lsky_nadir)
title('Lsky_nadir')

figure
fs = 15;
set(gcf,'color','white')
set(gca,'fontsize',fs)
plot(wavelength,Lrefl_sky_nadir)
title('Lrefl\_sky\_nadir')

figure
fs = 15;
set(gcf,'color','white')
set(gca,'fontsize',fs)
plot(wavelength,Rrs_nadir)
title('Rrs\_nadir')

figure
fs = 15;
set(gcf,'color','white')
set(gca,'fontsize',fs)
plot(wavelength,Rrs_theta_phi*pi*100)
title('Rrs\_theta\_phi')


%%
